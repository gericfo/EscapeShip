console.log("Script started successfully");const s={button1:{x:3,y:5,color:"red",pressed:!1},button2:{x:5,y:5,color:"red",pressed:!1},button3:{x:17,y:5,color:"blue",pressed:!1},button4:{x:19,y:5,color:"blue",pressed:!1}};WA.onInit().then(async()=>{console.log("Scripting API ready"),await WA.players.configureTracking({players:!0});for(const[e,{x:r,y:t}]of Object.entries(s))WA.room.area.create({name:e,x:r*32,y:t*32,width:32,height:32}),WA.room.area.onEnter(e).subscribe(()=>{WA.player.state.saveVariable("buttonPressed",e,{persist:!1,public:!0}),l()}),WA.room.area.onLeave(e).subscribe(()=>{WA.player.state.saveVariable("buttonPressed",void 0,{persist:!1,public:!0}),l()});WA.players.onPlayerEnters.subscribe(e=>{e.state.onVariableChange("buttonPressed").subscribe(()=>{l()})}),WA.players.onPlayerLeaves.subscribe(()=>{l()}),l()}).catch(e=>console.error(e));function l(){for(const a of Object.values(s))a.pressed=!1;let e=0,r=0;const t=[...WA.players.list(),WA.player];for(const a of t){const o=a.state.buttonPressed;typeof o=="string"&&(o==="button1"||o==="button2"||o==="button3"||o==="button4")&&(s[o].pressed=!0,s[o].color==="red"&&e++,s[o].color==="blue"&&r++)}d(),e>=1?(WA.room.showLayer("doors/red_door_opened"),WA.room.hideLayer("doors/red_door_closed")):(WA.room.hideLayer("doors/red_door_opened"),WA.room.showLayer("doors/red_door_closed")),r>=1?(WA.room.showLayer("doors/blue_door_opened"),WA.room.hideLayer("doors/blue_door_closed")):(WA.room.hideLayer("doors/blue_door_opened"),WA.room.showLayer("doors/blue_door_closed"))}function d(){let e=[];for(const{x:r,y:t,color:a,pressed:o}of Object.values(s))e.push({x:r,y:t,tile:a+(o?"_enabled":"_disabled"),layer:"buttons"});WA.room.setTiles(e)}
